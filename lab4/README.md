# Алгоритм СТОЛП (STOLP) — алгоритм отбора эталонных объектов для метрического классификатора.
Алгоритм STOLP выбирает из выборки эталонные объекты, уменьшая время классификации объектов и сокращая выборку.
В алгоритме используется функция отступа:

<a href="https://www.codecogs.com/eqnedit.php?latex=$M(x_i)&space;=&space;W_y(x_i,X^l)&space;-&space;\max\limits_{y&space;\in&space;Y\{y_i\}}W_y(x_i,X^l)&space;$" target="_blank"><img src="https://latex.codecogs.com/gif.latex?$M(x_i)&space;=&space;W_y(x_i,X^l)&space;-&space;\max\limits_{y&space;\in&space;Y\{y_i\}}W_y(x_i,X^l)&space;$" title="$M(x_i) = W_y(x_i,X^l) - \max\limits_{y \in Y\{y_i\}}W_y(x_i,X^l) $" /></a>

Где W функция веса, зависящая от алгоритма классификации 
Отступ показывает степень типичности объекта: чем больше <a href="https://www.codecogs.com/eqnedit.php?latex=$M(x_i)&space;$" target="_blank"><img src="https://latex.codecogs.com/gif.latex?$M(x_i)&space;$" title="$M(x_i) $" /></a>, тем глубже <a href="https://www.codecogs.com/eqnedit.php?latex=$x_i&space;$" target="_blank"><img src="https://latex.codecogs.com/gif.latex?$x_i&space;$" title="$x_i $" /></a> в своём классе.

Нахождение отступов:
```
margins <- function(xl,func)
{
  n <- dim(xl)[1]
  margin <- rep(0, n)
  for(i in 1:n)
  {
    z <- c(xl[i,1],xl[i,2])
    w <- func(xl[, 1:3][-i,],z)
    margin[i] <- w[xl[i,3]]- max(w[which(names(w)!=xl[i,3])])
  }
  return(margin)
}
```

Отступы делятся на:

Эталонные – имеют большой положительный отступ, плотно окружены объектами своего класса, наиболее типичный представитель своего класса.

Неинформативные – положительный отступ, не влияет на качество классификации.

Пограничные – отступ близкий к 0.

Ошибочные – отрицательный отступ, неверно классифицируемые.

Шумовые(выбросы) – большой отрицательный отступ, их удаление улучшает качество классификации.

Алгоритм:
1.	Удалить все выбросы.
2.	Взять по одному объекту из каждого класса с наибольшим отступом и добавить в множество эталонов.
3.	Пока множество эталонов и обучающая выборка не совпадут
*	Классифицировать объекты обучающей выборки, используя в качестве обучающей выборки множество эталонов. Посчитать количество ошибок.
*	Если количество ошибок равно 0 алгоритм.
*	Добавить к эталонным объектам, объект из обучающей выборки с наименьшим отступом.


# Пример работы алгоритма STOLP для алгоритма kwNN k=6, q=0.5

![Image alt](https://github.com/KOCTYN/ML0/blob/master/lab4/STOLP_for_kwNN.png)
Получилось 10 эталонных объектов.

# Карта классификации для kwNN для ирисов фишера без STOLP
![Image alt](https://github.com/KOCTYN/ML0/blob/master/lab4/kwnn_map.png)
Скорость работы алгоритма всей выборке 7.867457 mins

# Карта классификации для kwNN для ирисов фишера с STOLP
![Image alt](https://github.com/KOCTYN/ML0/blob/master/lab4/kwnn_map_etalon.png)
Скорость работы алгоритма на эталонных обьектах 19.53977 secs

Скорост работы алгоритма на эталоных объектах выше, из-за уменьшения размера обучающей выборки.
